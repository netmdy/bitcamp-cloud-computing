<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>자바 스크립트 </title>
</head>
<body>
<h1>AJAX 비동기 요청 - JSON 다루기</h1>

<button id="btn1">json 데이터 가져오기</button>

<form>
이름 : <input id="fiName" type="text"><br>
나이 : <input  id="fiAge" type="number"><br>
전화 : <input  id="fiTel" type="tel"><br>
</form>

<script type="text/javascript">
"use strict"

/*
AJAX(Asynchronous JavaScript And XML)
 비동기 요청에서 서버가 보낸 응답 결과를 받는 방법
 서버의 응답이 왔을 때 호출 될 메서드를
 XMLHttpRequest에 등록한다.
 */

 btn1.onclick = function() {
    
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(){

      if (xhr.readyState < 4) return;
      if (xhr.status != 200){
          alert("오류 발생 ㅇㅅㅇ");
          return;
      }
	  console.log(xhr.responseText);
     
// 서버에서 받은 JSON 문자열을 파싱하여 자바스크립트 객체로 바꾼 다음에 사용
	    var obj = JSON.parse(xhr.responseText);
	    console.log(obj.name);
	    console.log(obj.age);
	    console.log(obj.tel);

	    fiName.value = obj.name;
	    fiAge.value = obj.age;
	    fiTel.value = obj.tel;
    };

    xhr.open('GET', 'ex04-1.jsp', true);
    xhr.send();

    // 4. 서버에서 받은 응답 데이터를 추출한다.
  //      서버에서 응답이 오기 전에 서버가 보낸 응답 결과를
//        출력 하기 때문에 출력 결과는 없다.
}
  
</script>

</body>
</html>